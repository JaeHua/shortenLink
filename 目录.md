.
├─ api/                                 # 对外 HTTP 契约（goctl api）
│  ├─ convert/
│  │  └─ convert.api                    # POST /convert（鉴权），仅转发到 convert-rpc
│  └─ admin/                            # 可选：内部/管理接口
│     └─ sequence.api
│
├─ rpc/                                 # 服务间 RPC 契约（proto）
│  ├─ convert/
│  │  └─ convert.proto                  # Convert(longUrl)->shortUrl
│  ├─ show/
│  │  └─ show.proto                     # Resolve(shortCode)->longUrl
│  └─ sequence/                         # 可选：发号器独立
│     └─ sequence.proto                 # Next()->value
│
├─ cmd/
│  ├─ convert-api/                      # 转链对外 HTTP（鉴权、参数校验、转发 RPC）
│  │  ├─ main.go
│  │  └─ internal/
│  │     ├─ config/config.go            # 监听、鉴权、下游 convert-rpc 地址、限流等
│  │     ├─ handler/                    # 由 convert.api 生成；调用 convert-rpc 客户端
│  │     ├─ middleware/                 # 认证/鉴权、限流、签名校验
│  │     └─ svc/servicecontext.go       # 注入 convert-rpc 客户端
│  │
│  ├─ convert-rpc/                      # 转链核心业务（写路径）
│  │  ├─ main.go
│  │  └─ internal/
│  │     ├─ config/config.go            # DB、Redis、BaseString、ShortDomain 等
│  │     ├─ logic/
│  │     │  └─ convertlogic.go          # 迁移你现有 Convert 逻辑（去除 HTTP 细节）
│  │     ├─ server/convertserver.go     # goctl rpc 生成
│  │     ├─ svc/servicecontext.go       # 注入 model、sequence、bloom/黑名单等
│  │     └─ model/                      # 可放本服务私有 model（或复用根 model）
│  │
│  ├─ show-api/                         # 短链访问入口（Nginx 转发到这里）
│  │  ├─ main.go
│  │  └─ internal/
│  │     ├─ config/config.go            # 监听、下游 show-rpc 地址、重定向策略
│  │     ├─ handler/
│  │     │  └─ redirect.go              # GET /:code → 调用 show-rpc → 301/302 到 longUrl
│  │     ├─ middleware/
│  │     │  └─ accesslog.go             # 细粒度访问日志（补充 Nginx access.log）
│  │     └─ svc/servicecontext.go       # 注入 show-rpc 客户端
│  │
│  ├─ show-rpc/                         # 解析短链（读路径）
│  │  ├─ main.go
│  │  └─ internal/
│  │     ├─ config/config.go            # DB/缓存、读写分离、降级策略
│  │     ├─ logic/
│  │     │  └─ showlogic.go             # 根据 code 返回 longUrl（可读缓存/DB）
│  │     ├─ server/showserver.go
│  │     └─ svc/servicecontext.go
│  │
│  └─ sequence-rpc/                     # 可选：发号器服务（Redis/MySQL 实现）
│     ├─ main.go
│     └─ internal/
│        ├─ config/config.go
│        ├─ logic/nextlogic.go
│        ├─ server/sequenceserver.go
│        └─ svc/servicecontext.go
│
├─ pkg/                                 # 共享库
│  ├─ base62/
│  ├─ md5/
│  ├─ urltool/
│  ├─ auth/                             # 鉴权签名/JWT/AKSK
│  ├─ connect/                          # URL 可达性/健康检查
│  └─ middleware/                       # 通用中间件（trace、recover、metrics）
│
├─ internal/                            # 跨服务复用但不对外的组件（可选）
│  └─ observability/                    # 埋点/追踪适配
│
├─ model/                               # 若多服务共享表结构/DAO，可放根目录复用
│
├─ sequence/                            # 若不独立为 RPC，这里保留本地实现（Redis/MySQL）
│  ├─ mysql.go
│  └─ redis.go
│
├─ configs/                             # 各服务独立配置
│  ├─ convert-api.yaml
│  ├─ convert-rpc.yaml
│  ├─ show-api.yaml
│  ├─ show-rpc.yaml
│  └─ sequence-rpc.yaml
│
├─ deploy/
│  ├─ docker/
│  │  ├─ convert-api.Dockerfile
│  │  ├─ convert-rpc.Dockerfile
│  │  ├─ show-api.Dockerfile
│  │  ├─ show-rpc.Dockerfile
│  │  └─ sequence-rpc.Dockerfile
│  ├─ k8s/
│  │  ├─ convert-api.yaml               # Deployment/Service/HPA
│  │  ├─ convert-rpc.yaml
│  │  ├─ show-api.yaml
│  │  ├─ show-rpc.yaml
│  │  └─ sequence-rpc.yaml
│  └─ nginx/
│     ├─ nginx.conf                     # 将短链域名转发到 show-api
│     └─ conf.d/
│        └─ shortener.conf              # server_name 短域名 → proxy_pass show-api
│
├─ ops/
│  ├─ efk/                              # EFK 收集与索引
│  │  ├─ filebeat/                      # 收集 Nginx access.log 和各服务日志
│  │  ├─ elasticsearch/
│  │  └─ kibana/
│  └─ grafana/
│     ├─ dashboards/
│     │  ├─ api-gateway.json
│     │  ├─ convert-rpc.json
│     │  └─ show-rpc.json
│     └─ prometheus/                    # 指标采集配置
│
├─ scripts/                             # 生成与发布脚本
│  ├─ gen_api.sh                        # goctl api 生成
│  ├─ gen_rpc.sh                        # goctl rpc 生成
│  ├─ migrate.sql
│  └─ make_release.sh
│
├─ go.mod
└─ README.md